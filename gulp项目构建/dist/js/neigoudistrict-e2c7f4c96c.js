/**
 * yidao
 * created by 用车前端组
 */
"use strict";var root=window||{},util=root.util||{},NeiGouDistrict=function(t){this.options=$.extend({sel:"",hrefParma:util.getHrefParma(),dstrict:{p:0,pn:"",c:0,cn:"",d:0,dn:""},msg:{m1:"城市选择有误",m2:"修改成功"},requestState:{setareaSave:!0}},t),this.sel=this.options.sel,this.el=$(this.sel)};$.extend(NeiGouDistrict.prototype,{init:function(){var t=this;t.load(),t.addEvent()},load:function(){var t=this,i=t.options.hrefParma,e=i.c||"";t.getDistrict(e)},renderItem:function(t){var i="";t=t||[];for(var e=0,o=t.length;e<o;e++)i+='<li val="'+t[e].C+'" fn="'+t[e].F+'">'+t[e].N+"</li>";$("#list").html(i)},getDistrict:function(t){var i=this,e=t.slice(0,2)+"0000";util.api({surl:root.PVC_API_PATH+e+".json",type:"get",beforeSend:function(){util.comShow({txt:"正在努力加载中…",icl:"i-load ro360"})},success:function(e){var o=e.cld||[],s=[],r={};i.options.dstrict.p=e.C,i.options.dstrict.pn=e.N;for(var n=0,a=o.length;n<a;n++)if(r=o[n]||{},t==r.C){i.options.dstrict.c=r.C,i.options.dstrict.cn=r.N,s=r.cld;break}i.renderItem(s)},complete:function(){util.remComShow()}})},setareaSave:function(t){var i=this;return!!i.options.requestState.setareaSave&&(t?void util.api({surl:root.MB_API_PATH+"modudtal",data:{mod:16,area:t},type:"post",beforeSend:function(){i.options.requestState.setareaSave=!1},success:function(t){var i=t.rpco;t.body||{};switch(i){case 200:util.href("set.html");break;default:util.tip("保存失败")}},complete:function(){i.options.requestState.setareaSave=!0}}):(alert(i.options.msg.m1),!1))},save:function(){var t=this,i=t.options.hrefParma,e=t.options.dstrict.d,o=(t.options.dstrict.dn,t.options.dstrict.fn),s=i.b,r={d:e,areafull:o,isMod:1};switch(i.gname&&(r.gname=i.gname),i.mob&&(r.mob=i.mob),i.refid&&(r.refid=i.refid),i.foi&&(r.foi=i.foi),s){case"1":break;default:util.href(i.cbu,r)}},addEvent:function(){var t=this,i=util.getClick();t.el.on(i,"#list li",function(){t.options.dstrict.d=$(this).attr("val")||"",t.options.dstrict.dn=$(this).text()||"",t.options.dstrict.fn=$(this).attr("fn")||"",t.save()})}});