/**
 * yidao
 * created by 用车前端组
 */
"use strict";var root=window||{},util=root.util||{},CertificateDetail=function(t){this.options=$.extend({sel:"",hrefParma:util.getHrefParma(),certNameReg:/^[^\s]+$/,certNoReg:/^[^\s]+$/,ceType:{1:"身份证",2:"户口薄",3:"护照",4:"军官证",5:"士兵证",6:"港澳居民来往内地通行证",7:"台湾同胞来往内地通行证",8:"临时身份证",9:"外国人居留证",10:"警官证"},certificate:{cetp:"",oname:"",ceno:"",state:1},msg:{m1:"请输入证件持有者姓名",m2:"请输入证件号",m3:"新增成功",m4:"证件类型错误，请重新选择",m5:"不可重复绑定同一类型证件",m6:"姓名不能包含空格",m7:"证件号不能包含空格"},requestState:{save:!0}},t),this.sel=this.options.sel,this.el=$(this.sel)};$.extend(CertificateDetail.prototype,{init:function(){var t=this;t.load(),t.addEvent()},load:function(){var t=this,e=this.options.hrefParma,i=e.actype||"",o=t.options.ceType[i]||"";t.options.certificate.cetp=i,o&&$("#certType").html(o)},_save:function(t){var e=this;util.api({surl:root.MB_API_PATH+"modcertifi",data:t,type:"post",beforeSend:function(){e.options.requestState.save=!1},success:function(t){var i=t.rpco;t.body||{};switch(i){case 200:util.href("certificatelist.html");break;case 40002:util.tip(e.options.msg.m5);break;default:util.tip("保存失败")}},complete:function(){e.options.requestState.save=!0}})},save:function(){var t=this,e=$("#certName").val(),i=$("#certNo").val();return!!t.options.requestState.save&&(t.options.certificate.cetp?e?t.options.certNameReg.test(e)?i?t.options.certNoReg.test(i)?($.extend(t.options.certificate,{oname:e,ceno:i,state:util.OPT_STATE.UPDATE}),void t._save(t.options.certificate)):(util.tip(t.options.msg.m7),!1):(util.tip(t.options.msg.m2),!1):(util.tip(t.options.msg.m6),!1):(util.tip(t.options.msg.m1),!1):(util.tip(t.options.msg.m4),!1))},addEvent:function(){var t=this,e=util.getClick();t.options.hrefParma;t.el.on(e,"#save",function(){t.save()})}});