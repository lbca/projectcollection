/**
 * yidao
 * created by 用车前端组
 */
"use strict";var root=window||{},util=root.util||{},SetPhone=function(t){this.options=$.extend({sel:"",hrefParma:util.getHrefParma(),phone:"",mbsn:"",msg:{m1:"是否确认解绑当前手机号？<br>解绑后该号码将不能作为登录名使用。",m2:"若解绑手机号，需设置美服号"},requestState:{delphone:!0}},t),this.sel=this.options.sel,this.el=$(this.sel)};$.extend(SetPhone.prototype,{init:function(){var t=this;t.load(),t.addEvent()},load:function(){var t=this,e=t.options.hrefParma,o=e.phone;t.options.phone=o,t.options.mbsn=e.mbsn||"",o?($("#phone").html(o),$("#have").show(),$(".header .btn").show()):$("#unHave").show()},_delphone:function(t){var e=this;util.api({surl:root.MB_API_PATH+"modmobile",data:{mobile:t,state:util.OPT_STATE.DELETE},type:"post",beforeSend:function(){e.options.requestState.delphone=!1},success:function(e){var o=e.rpco;switch(o){case 200:util.href("setphonefinish.html",{phone:t,operate:"del"});break;default:util.tip("解绑失败")}},complete:function(){e.options.requestState.delphone=!0}})},delphone:function(){var t=this;return t.options.mbsn?void util.alert(t.options.msg.m1,{defBtnIndex:1,justOk:!1,okFn:function(){var e=t.options.phone;return!!t.options.requestState.delphone&&(!!e&&void t._delphone(e))}}):(util.alert(t.options.msg.m2),!1)},addEvent:function(){var t=this,e=util.getClick();t.options.hrefParma;t.el.on(e,"#addBind",function(){util.href("setphoneinput.html",{operate:"add"})}),t.el.on(e,"#modBind",function(){util.href("setphoneinput.html",{operate:"mod",phone:t.options.phone})}),t.el.on(e,"#unBind",function(){t.delphone()})}});