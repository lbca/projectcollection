/**
 * yidao
 * created by 用车前端组
 */
"use strict";var root=window||{},util=root.util||{},GomegjNews=function(t){this.options=$.extend({sel:"",hrefParma:util.getHrefParma(),pading:{currentPage:1,pageDataCount:20,totalCount:0},iscrollPaging:null,msg:{},requestState:{}},t),this.sel=this.options.sel,this.el=$(this.sel)};$.extend(GomegjNews.prototype,{init:function(){var t=this;t.load(),t.addEvent()},load:function(){var t=this,i=t.options.hrefParma,e=i.rcid||"";1==i.isfirst||$(".goBack").attr("href","javascript:util.href('index.html');").show(),t.getResource(e,t.options.pading.currentPage,t.options.pading.pageDataCount)},getResource:function(t,i,e){var o=this;util.api({surl:root.RESGRP_API_PATH+"reslist",data:{rcid:t,page:i,len:e},type:"get",beforeSend:function(){util.comShow({txt:"正在努力加载中…",icl:"i-load ro360"})},success:function(i){var e,n,a=i.rpco,s=i.body||{};switch(a){case 200:e=s.res||[],n=s.total||0,o.renderResource(s),o.options.iscrollPaging?o.options.iscrollPaging.reLoadPagingOption({currentPage:o.options.pading.currentPage,totalCount:n}):(o.options.iscrollPaging=new IscrollPaging({totalCount:n,pageDataCount:o.options.pading.pageDataCount,loadDataFun:function(){o.options.pading.currentPage++,o.getResource(t,o.options.pading.currentPage,o.options.pading.pageDataCount)}}),o.options.iscrollPaging.init());break;case 404:$("#noList").show();break;default:util.tip("查询失败")}},complete:function(){util.remComShow()}})},renderResource:function(t){var i,e=t.res||[],o="",n=0,a=0,s=parseInt(($("#list").width()-124)/16*2)-2;t.cname&&$("#title").html(t.cname);for(var r=0,l=e.length;r<l;r++)i=e[r].title||"",i=i.length>s?i.substring(0,s)+"...":i,n=e[r].rctime||"",n=util.formateDate(n,"yyyy-MM-dd").substring(2),a=e[r].rdnum||0,a>9999&&(a="9999+"),o+='<li href="'+e[r].href+'"><i class="text-icon i" style="background-image: url(\''+e[r].iurl+'\');"></i><div class="text-detail">'+i+'</div><span class="lbtxt">'+n+'</span><span class="rbicontxt"><i class="i i-eye"></i>'+a+"</span></li>";l||$("#noList").show(),o&&(1===$(".iscrollpading-pulltext").length?$(".iscrollpading-pulltext").before(o):$("#list").html(o))},addEvent:function(){var t=this,i=util.getClick();t.options.hrefParma;t.el.on(i,"#list li",function(){util.href($(this).attr("href"))}),$(window).resize(function(){window.location.reload()})}});