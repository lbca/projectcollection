/**
 * yidao
 * created by 用车前端组
 */
"use strict";var root=window||{},util=root.util||{},AreaDistrict=function(t){this.options=$.extend({sel:"",hrefParma:util.getHrefParma(),dstrict:{p:0,pn:"",c:0,cn:"",d:0,dn:""},msg:{m1:"城市选择有误",m2:"修改成功"},requestState:{setareaSave:!0}},t),this.sel=this.options.sel,this.el=$(this.sel)};$.extend(AreaDistrict.prototype,{init:function(){var t=this;t.load(),t.addEvent()},load:function(){var t=this,e=t.options.hrefParma,i=e.c||"";t.getDistrict(i)},renderItem:function(t){var e="";t=t||[];for(var i=0,o=t.length;i<o;i++)e+='<li val="'+t[i].C+'">'+t[i].N+"</li>";$("#list").html(e)},getDistrict:function(t){var e=this,i=t.slice(0,2)+"0000";util.api({surl:root.PVC_API_PATH+i+".json",type:"get",beforeSend:function(){util.comShow({txt:"正在努力加载中…",icl:"i-load ro360"})},success:function(i){var o=i.cld||[],s=[],r={};e.options.dstrict.p=i.C,e.options.dstrict.pn=i.N;for(var a=0,n=o.length;a<n;a++)if(r=o[a]||{},t==r.C){e.options.dstrict.c=r.C,e.options.dstrict.cn=r.N,s=r.cld;break}e.renderItem(s)},complete:function(){util.remComShow()}})},setareaSave:function(t){var e=this;return!!e.options.requestState.setareaSave&&(t?void util.api({surl:root.MB_API_PATH+"modudtal",data:{mod:16,area:t},type:"post",beforeSend:function(){e.options.requestState.setareaSave=!1},success:function(t){var e=t.rpco;t.body||{};switch(e){case 200:util.href("set.html");break;default:util.tip("保存失败")}},complete:function(){e.options.requestState.setareaSave=!0}}):(alert(e.options.msg.m1),!1))},save:function(){var t=this,e=t.options.hrefParma,i=t.options.dstrict.d,o=(t.options.dstrict.dn,e.b),s={d:t.options.dstrict.d};switch(o){case"1":t.setareaSave(i);break;default:util.href(e.cbu,s)}},addEvent:function(){var t=this,e=util.getClick();t.el.on(e,"#list li",function(){t.options.dstrict.d=$(this).attr("val")||"",t.options.dstrict.dn=$(this).text()||"",t.save()})}});