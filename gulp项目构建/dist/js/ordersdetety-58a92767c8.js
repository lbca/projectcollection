/**
 * yidao
 * created by 用车前端组
 */
"use strict";var root=window||{},util=root.util||{},OrdersDetEty=function(t){this.options=$.extend({sel:"",hrefParma:util.getHrefParma(),ivifm:{1:"已开",2:"未开"},dtwayAll:{1:"用户自提",2:"集中配送",3:"安装带货",4:"配送自提",5:"门店配送",6:"厂家安装带货",7:"待预约配送"},listMinHeight:178,msg:{}},t),this.sel=this.options.sel,this.el=$(this.sel)};$.extend(OrdersDetEty.prototype,{init:function(){var t=this;t.load(),t.addEvent()},load:function(){var t=this,e=t.options.hrefParma;t.getEntityOrderDetail(e.otn,e.dodt)},getEntityOrderDetail:function(t,e){var i=this;util.api({surl:root.AS_API_PATH+"etoddt",data:{otn:t,dodt:e},type:"get",success:function(t){var e=t.rpco,o=t.body||{};switch(e){case 200:i.renderEntityOrderDetail(o);break;case 404:util.comShow({txt:"非常抱歉，您访问的订单不存在",icl:"i-page"});break;default:util.tip("查询失败")}}})},renderEntityOrderDetail:function(t){var e,i=this,o=t.spnm+"-售货员"+t.spep,a="",s=t.gdls||[],d=0,l="",r="",n=0;$("#salesclerkInfo").html(o),a='<ul class="list-text icon">';for(var h=0,m=s.length;h<m;h++)a+='<li><img class="text-icon" src="'+s[h].gdiul+'"><div class="text-detail tod wp70">'+s[h].gdnm+'</div><div class="text-detail">价格：'+(s[h].gdpr/100).toFixed(2)+'</div><div class="text-detail">'+s[h].gdnu+"件</div>",2===t.dtway&&(a+='<span class="btn btn-linear js-orderstate" otn="'+s[h].otn+'">配送状态</span>'),a+="</li>",d+=s[h].gdnu;m<2?$(".js-moregoods").remove():$("#list").height(i.options.listMinHeight),a+="</ul>",$("#productCount").html(d),$("#list").html(a),t.spsr&&$("#spsr").html(t.spsr),t.atdvtt&&(l+=util.formateDate(t.atdvtt,"yyyy-MM-dd hh:mm"))&&t.atdvte&&(l+="~"+util.formateDate(t.atdvte,"MM-dd hh:mm")),l&&$("#atdvt").html(l),t.atitcts&&(r+=util.formateDate(t.atitcts,"yyyy-MM-dd hh:mm"))&&t.atitcte&&(r+="~"+util.formateDate(t.atitcte,"MM-dd hh:mm")),r&&$("#atitct").html(r),t.cname&&$("#cname").html(t.cname),t.cphone&&$("#cphone").html(t.cphone),t.faddr&&$("#faddr").html(t.faddr),i.options.hrefParma.otn&&$("#otn").html(i.options.hrefParma.otn),t.sdodt&&$("#sdodt").html(util.formateDate(parseInt(t.sdodt),"yyyy-MM-dd hh:mm")),t.dtway&&$("#dtway").html(i.options.dtwayAll[t.dtway]),e=i.options.ivifm[t.ivifm]||"",e&&$("#ivifm").html(e),t.gtam&&($("#gtam").html("¥"+(t.gtam/100).toFixed(2)),n+=t.gtam),t.frgt&&($("#frgt").html("¥"+(t.frgt/100).toFixed(2)),n+=t.frgt),n&&$("#actualMoney").html("¥"+(n/100).toFixed(2))},addEvent:function(){var t=this,e=util.getClick(),i=t.options.hrefParma;t.el.on(e,".js-orderstate",function(){var t=$(this).attr("otn")||"",e={otn:t,dodt:i.dodt};util.href("ordersstaety.html",e)}),t.el.on(e,"#openMoreGoods",function(){$(this).hide(),$("#closeMoreGoods").show(),$("#list").animate({height:$("#list li").length*$("#list li:first").height()},"ease-out")}),t.el.on(e,"#closeMoreGoods",function(){$(this).hide(),$("#openMoreGoods").show(),$("#list").animate({height:2*$("#list li:first").height()-2},"ease-out")})}});