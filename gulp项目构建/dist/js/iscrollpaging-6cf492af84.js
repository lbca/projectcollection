/**
 * yidao
 * created by 用车前端组
 */
"use strict";var root=window||{},util=root.util||{},IscrollPaging=function(o){this.options=$.extend({sel:".iscrollpading",pullListSel:".iscrollpading-list",pullTextSel:".iscrollpading-pulltext",scroll:null,scrollOption:{mouseWheel:!0,scrollbars:!0,fadeScrollbars:!0,probeType:2,click:!0},pullWidthForLoad:20,lastPullY:0,loadDataFun:null,currentPage:1,pageDataCount:20,totalCount:0,totalPage:0,lastPage:!1,msg:{m1:"上拉显示更多",m2:"释放显示更多",m3:"正在加载",m4:"最后一页"}},o),this.sel=this.options.sel,this.el=$(this.sel)};$.extend(IscrollPaging.prototype,{init:function(){var o=this;o.load()},load:function(){var o=this,t=o.options.totalPage||Math.ceil(o.options.totalCount/o.options.pageDataCount);o.options.scroll=new IScroll(o.options.sel,o.options.scrollOption),t>1&&($(o.options.pullListSel).append('<span class="iscrollpading-pulltext">'+o.options.msg.m1+"</span>"),o.addEvent(),o.options.scroll.refresh())},scrollDestroy:function(){var o=this;o.options.scroll&&o.options.scroll.destroy()},scrollRefresh:function(){var o=this;o.options.scroll&&o.options.scroll.refresh()},reLoadPagingOption:function(o){var t=this;$.extend(t.options,o),t.options.totalPage=t.options.totalPage||Math.ceil(t.options.totalCount/t.options.pageDataCount),t.options.lastPage=t.options.totalPage==t.options.currentPage,$(t.options.pullTextSel).html(t.options.msg.m1),t.options.lastPage&&$(t.options.pullTextSel).html(t.options.msg.m4),t.options.scroll.refresh()},scroll:function(o){var t=this,l=o.maxScrollY-o.y;return!t.options.lastPage&&(l>=t.options.pullWidthForLoad?$(t.options.pullTextSel).html(t.options.msg.m2):l<t.options.pullWidthForLoad&&$(t.options.pullTextSel).html(t.options.msg.m1),void(t.options.lastPullY=o.y))},scrollEnd:function(o){var t=this,l=o.maxScrollY-t.options.lastPullY;return!t.options.lastPage&&void(l>=t.options.pullWidthForLoad&&t.loadData())},loadData:function(){var o=this;$(o.options.pullTextSel).html(o.options.msg.m3),o.options.loadDataFun&&o.options.loadDataFun()},addEvent:function(){var o=this,t=util.getClick();o.options.scroll.on("scroll",function(){o.scroll(this)}),o.options.scroll.on("scrollEnd",function(){o.scrollEnd(this)}),o.el.on(t,o.options.pullTextSel,function(){return!o.options.lastPage&&void o.loadData()})}});