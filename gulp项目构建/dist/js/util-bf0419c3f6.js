/**
 * yidao
 * created by 用车前端组
 */
"use strict";var root=window||{};root.BASE_PATH="/",root.API_PATH=root.BASE_PATH+"",root.CM_API_PATH=root.BASE_PATH+"common/v1/",root.MB_API_PATH=root.BASE_PATH+"member/v1/",root.AS_API_PATH=root.BASE_PATH+"asset/v1/",root.BSNS_API_PATH=root.BASE_PATH+"business/v1/",root.RESGRP_API_PATH=root.BASE_PATH+"webres/v1/",root.WXCM_API_PATH=root.BASE_PATH+"wxcommon/v1/",root.WXP_API_PATH=root.BASE_PATH+"wxpay/v1/sod/",root.PVC_API_PATH=root.BASE_PATH+"json/pvc/",root.SERAREA_API_PATH=root.BASE_PATH+"json/servicearea/",root.EDOC_API_PATH=root.BASE_PATH+"edoc/GomeWordWeb/asset/v1/wx/",root.USERPIC_API_PATH=root.BASE_PATH+"member/v1/getheader?id=",root.MSGBOARD_API_PATH=root.BASE_PATH+"edoc/scmi/scmi/",root.REPORTCHART_API_PATH=root.BASE_PATH+"stats/v1/",root.PURCHASING_API_PATH=root.BASE_PATH+"purchasing/v1/",root.VERSION="48",root.EMPTY_FN=function(){},root.util={interval:{},noWxLogin:window.NO_WXLOGIN},root.util.OPT_STATE={UPDATE:1,DISABLED:2,DELETE:3},$.extend(root.util,{isWeixin:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},getClick:function(){return this.checkSupportTouch()?"tap":"click"},getMousedown:function(){return this.checkSupportTouch()?"touchstart":"mousedown"},getMouseup:function(){return this.checkSupportTouch()?"touchend":"mouseup"},getMousemove:function(){return this.checkSupportTouch()?"touchmove":"mousemove"},checkSupportTouch:function(){return"undefined"!=typeof window.document.ontouchstart},strEncrypt:function(t,e,o,n){var t=t+"",n=n||"*",r=e+o-1;return t&&t.replace(/./g,function(t,o){return o>=e&&o<=r?n:t})},formateDate:function(t,e){var o,n,r,i,a,c,l="";return"string"==typeof t&&(t=t.replace(/-/g,"/")),t=new Date(t),isNaN(t.getTime())||(o=t.getFullYear(),n=t.getMonth()+1,n<10&&(n="0"+n),r=t.getDate(),r<10&&(r="0"+r),i=t.getHours(),i<10&&(i="0"+i),a=t.getMinutes(),a<10&&(a="0"+a),c=t.getSeconds(),c<10&&(c="0"+c),l=e.replace(/yyyy/g,o).replace(/MM/g,n).replace(/dd/g,r).replace(/hh/g,i).replace(/mm/g,a).replace(/ss/g,c)),l},getHrefParma:function(t){var e,o,n,r,i={},a=[],c="";t?(e=t.indexOf("?"),t=e>-1?t.slice(e+1):""):t=decodeURI(window.location.search.slice(1)),e=t.indexOf("ou="),e>-1&&(i.ou=t.slice(e+3),t=t.slice(0,e)),a=t.split("&");for(var e in a)c=a[e],o=c.indexOf("="),o<0||(n=c.slice(0,o),r=c.slice(o+1),i[n]="cbu"===n?util.decode(r):r);return i},setHrefParma:function(t,e){var e=e||{},o="";if(e=$.extend(util.getHrefParma(t),e),t&&e){t=t.replace(/\?.*$/,"");for(var n in e)e.hasOwnProperty(n)&&"ou"!==n&&"cbu"!==n&&(o+=n+"="+e[n]+"&");e.cbu&&(o+="cbu="+util.encode(e.cbu)+"&"),e.ou&&(o+="ou="+e.ou+"&"),o&&(t+="?"+o.replace(/&$/,""))}return t},getJumpUrl:function(t){var e=t.url,o=t.urlParma,n=t.isSaveou,r=decodeURI(window.location.pathname+window.location.search);return 0===e.indexOf("javascript:")||(o=o||{},n&&(o.ou=r),o.v=root.VERSION,e=util.setHrefParma(e,o)),encodeURI(e)},href:function(t,e,o){window.location.href=util.getJumpUrl({url:t,urlParma:e,isSaveou:o})},replace:function(t,e,o){window.location.replace(util.getJumpUrl({url:t,urlParma:e,isSaveou:o}))},api:function(t){var e=t.success||root.EMPTY_FN,o=t.error||root.EMPTY_FN,n=t.complete||root.EMPTY_FN,r=t.beforeSend||root.EMPTY_FN,i=(new Date).getTime();t.url=t.surl?t.surl:root.API_PATH+t.url,t.url+=(t.url.indexOf("?")>-1?"&":"?")+"ct="+i,t=$.extend({timeout:1e4,type:"post",async:!0,dataType:"json",contentType:"application/json; charset=utf-8"},t,{success:function(t,o,n){return t&&t.rpco&&401===t.rpco?util.login(t.furl):e.apply(this,arguments)},beforeSend:function(){return r.apply(this,arguments)},error:function(t,e){return util.comShow({txt:"您的网络异常，加载失败，请您<br>重新尝试",link:"javascript: window.location.reload();",btn:"重新加载",icl:"i-abnormal"}),o.apply(this,arguments)},complete:function(t,e){return n.apply(this,arguments)}}),"post"==t.type&&t.data&&(t.data=JSON.stringify(t.data));var a=$.ajax(t);return a}}),$.extend(root.util,{alert:function(t,e){var o=$.extend({content:"",title:"提示",txtal:"center",justOk:!0,defBtnIndex:-1,okBtnText:"确定",cancelBtnText:"取消",okFn:function(){},cancelFn:function(){}},e),n="";$(".dialog").remove(),n='<div class="dialog"><div class="tablecell"><div class="alert"><div class="alert-title">'+o.title+'</div><div class="alert-content" style="text-align: '+o.txtal+';">'+t+'</div><div class="alert-btn"><span id="alert-ok">'+o.okBtnText+'</span><span id="alert-cancel">'+o.cancelBtnText+"</span></div></div></div></div>",$("body").append(n),o.justOk&&$("#alert-cancel").remove(),o.defBtnIndex>-1&&$(".alert-btn span:eq("+o.defBtnIndex+")").css("font-weight","bold"),$("#alert-ok").off().on("click",function(){$(".dialog").remove(),o.okFn&&o.okFn()}),$("#alert-cancel").off().on("click",function(){$(".dialog").remove(),o.cancelFn&&o.cancelFn()})},prompt:function(t,e){var o=$.extend({content:"",inpuPlaceholderArray:[],title:"提示",txtal:"center",justOk:!0,defBtnIndex:-1,okBtnText:"确定",cancelBtnText:"取消",okFn:function(){},cancelFn:function(){}},e),n="",r="";$(".dialog").remove();for(var i=0,a=o.inpuPlaceholderArray.length;i<a;i++)r+='<div class="alert-input '+(i===a-1?"mb20":"")+'"><input class="wl100" id="lgtk" type="text" placeholder="'+o.inpuPlaceholderArray[i]+'" maxlength="32"></div>';n='<div class="dialog"><div class="tablecell"><div class="alert prompt"><div class="alert-title">'+o.title+'</div><div class="alert-content" style="text-align: '+o.txtal+';">'+t+"</div>"+r+'<div class="alert-btn"><span id="alert-ok">'+o.okBtnText+'</span><span id="alert-cancel">'+o.cancelBtnText+"</span></div></div></div></div>",$("body").append(n),o.justOk&&$("#alert-cancel").remove(),o.defBtnIndex>-1&&$(".alert-btn span:eq("+o.defBtnIndex+")").css("font-weight","bold"),$("#alert-ok").off().on("click",function(){o.okFn?o.okFn()!==!1&&$(".dialog").remove():$(".dialog").remove()}),$("#alert-cancel").off().on("click",function(){o.cancelFn?o.cancelFn()!==!1&&$(".dialog").remove():$(".dialog").remove()})},tip:function(t,e){var t=t||"",o="",e=e||{},n=e.duration||"800",r=e.iconClass||"";$(".alert-tip").remove(),o=r?'<div class="alert-tip"><span class="msg msg-icon"><i class="i '+r+'"></i>'+t+"</span></div>":'<div class="alert-tip"><span class="msg">'+t+"</span></div>",$("body").append(o),clearInterval(util.interval),util.interval=setTimeout(function(){util.interval=setInterval(function(){var t=parseFloat($(".alert-tip").css("opacity")-.1).toFixed(1);t>0?$(".alert-tip").css("opacity",t):(clearInterval(util.interval),$(".alert-tip").remove())},50)},n)},countDown:function(t){var e=t.elem||{},o=t.downTime||60,n=t.formate||"count",r=$.isFunction(t.callback)?t.callback:function(){},i=e.get(0).id+"Interval",a=e.text();clearInterval(util[i]),e.html(n.replace(/count/,o)).addClass("countdown"),util[i]=setInterval(function(){o--,o>0?e.html(function(t,e){return n.replace(/count/,o)}):(clearInterval(util[i]),e.removeClass("countdown").html(a),r())},1e3)},comShow:function(t){var t=t||{},e=t.txt||"",o=t.btn||"",n=t.link||"javascript:;",r=t.icl||"",i="";i+='<div class="tuwen maxtop bcgray" id="commonShow"><div class="tu"><i class="i '+r+'"></i></div>',e&&(i+='<p class="wen">'+e+"</p>"),o&&(i+='<a class="btn btn-footer" href="'+n+'" >'+o+"</a>"),i+="</div>",util.remComShow(),$("body").append(i),$("#commonShow").css({top:$(".container").css("top"),bottom:"0"})},remComShow:function(){$("#commonShow").remove()},clickGrayEffect:function(t){var e=t.offset().top,o=t.height();util.remClickGrayEffect(),$("body").append('<div id="clickGrayEffect" style="width: 100%; height: '+(o+1)+"px; position: absolute; top: "+(e-1)+'px; left: 0; background-color: rgba(0, 0, 0, .1);"></div>'),$("#clickGrayEffect").on(util.getMouseup(),function(){util.remClickGrayEffect()})},remClickGrayEffect:function(){$("#clickGrayEffect").remove()}}),$.extend(root.util,{loadCommonActionLoad:function(){util.noWxLogin||util.wxlogin(),util.loadGoBack(),util.loadMenuEvent(),util.loadInputClearBtn(),util.loadEnterKeySubmit(),util.loadClickGrayEffect(),util.loadNumberInputLimit()},loadGoBack:function(){util.getHrefParma().ou;$(".goBack").attr("href")||$(".goBack").attr("href","javascript:window.history.back();")},loadMenuEvent:function(){var t=$(".header .menu");return!!t.length&&void $(document).on(util.getClick(),function(e){var o=$(e.target);return o.is(".header .btn")||o.is(".header .btn .i-more")&&t.is(":hidden")?void t.show():void t.hide()})},loadInputClearBtn:function(){$(".js-clearInput").off().on(util.getClick(),function(){$(this).parent().find("input").val("")})},loadEnterKeySubmit:function(){$("input, textarea").on("keyup",function(t){13===t.keyCode&&$(".js-entersave").trigger(util.getClick())})},loadClickGrayEffect:function(){$("[cge]").on("touchstart","li:not([nocge])",function(){util.clickGrayEffect($(this))}),$("[cge]").on("touchend","li:not([nocge])",function(){util.remClickGrayEffect()}),$("[cge]").on("touchmove",function(){util.remClickGrayEffect()})},loadNumberInputLimit:function(){$(document).on("input propertychange","input.js-number",function(){var t=$(this).val().replace(/[^0-9]/g,"");$(this).val(t)})},wxlogin:function(){var t=util.getHrefParma(),e=t.code,o=t.state;e&&util.api({surl:root.CM_API_PATH+"wxlogin",data:{wxcode:e,wxstate:o},type:"post",async:!1,success:function(t){var e=t.rpco;switch(e){case 201:util.href("/accsmfail.html");break;case 40001:case 40002:case 50001:}}})},login:function(t){util.isWeixin()?util.alert("您的访问已超时，页面将重新刷新。",{justOk:!1,defBtnIndex:0,okFn:function(){var t=root.WXCM_API_PATH+"wxrc?furl="+window.location.href;util.href(t)}}):t?util.href("/login.html",{ou:t}):util.href("/login.html",{},!0)}}),$.extend(root.util,{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var e,o,n,r,i,a,c,l="",u=0;for(t=this._utf8_encode(t);u<t.length;)e=t.charCodeAt(u++),o=t.charCodeAt(u++),n=t.charCodeAt(u++),r=e>>2,i=(3&e)<<4|o>>4,a=(15&o)<<2|n>>6,c=63&n,isNaN(o)?a=c=64:isNaN(n)&&(c=64),l=l+util._keyStr.charAt(r)+util._keyStr.charAt(i)+util._keyStr.charAt(a)+util._keyStr.charAt(c);return l},decode:function(t){var e,o,n,r,i,a,c,l="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<t.length;)r=util._keyStr.indexOf(t.charAt(u++)),i=util._keyStr.indexOf(t.charAt(u++)),a=util._keyStr.indexOf(t.charAt(u++)),c=util._keyStr.indexOf(t.charAt(u++)),e=r<<2|i>>4,o=(15&i)<<4|a>>2,n=(3&a)<<6|c,l+=String.fromCharCode(e),64!=a&&(l+=String.fromCharCode(o)),64!=c&&(l+=String.fromCharCode(n));return l=this._utf8_decode(l)},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",o=0;o<t.length;o++){var n=t.charCodeAt(o);n<128?e+=String.fromCharCode(n):n>127&&n<2048?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},_utf8_decode:function(t){for(var e="",o=0,n=c1=c2=0;o<t.length;)n=t.charCodeAt(o),n<128?(e+=String.fromCharCode(n),o++):n>191&&n<224?(c2=t.charCodeAt(o+1),e+=String.fromCharCode((31&n)<<6|63&c2),o+=2):(c2=t.charCodeAt(o+1),c3=t.charCodeAt(o+2),e+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),o+=3);return e}}),util.loadCommonActionLoad();